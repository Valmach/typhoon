%%
%%   Copyright 2015 Zalando SE
%%
%%   Licensed under the Apache License, Version 2.0 (the "License");
%%   you may not use this file except in compliance with the License.
%%   You may obtain a copy of the License at
%%
%%       http://www.apache.org/licenses/LICENSE-2.0
%%
%%   Unless required by applicable law or agreed to in writing, software
%%   distributed under the License is distributed on an "AS IS" BASIS,
%%   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
%%   See the License for the specific language governing permissions and
%%   limitations under the License.
%%
{sys, [
   {lib_dirs, ["../apps", "../deps"]},
   {erts, [{mod_cond, derived}, {app_file, strip}]},
   {app_file, strip},
   {rel, "typhoon", "0.1.0",
      [
         kernel,
         stdlib,
         typhoon,
         aura,
         zephyrus
      ]
   },
   {rel, "start_clean", "",
      [
         kernel,
         stdlib
      ]
   },
   {boot_rel, "typhoon"},
   {profile, embedded},
   {incl_cond, derived},
   {excl_archive_filters, [".*"]}, 
   {excl_sys_filters, [
      "^bin/(?!start_clean.boot)",
      "^erts.*/bin/(dialyzer|typer)",
      "^erts.*/(doc|info|include|lib|man|src)"
   ]},
   {excl_app_filters, ["\.gitignore"]},
   {app, typhoon, [{mod_cond, app}, {incl_cond, include}]}
]}.

{target_dir, "typhoon-0.1.0"}.
{overlay, [
   {copy, "files/erl", "\{\{erts_vsn\}\}/bin/erl"},
   {copy, "files/nodetool", "releases/\{\{rel_vsn\}\}/nodetool"},
   {copy, "files/typhoon", "bin/typhoon"},
   {copy, "files/typhoon.docker", "bin/typhoon.docker"},
   {copy, "files/install_upgrade.escript", "bin/install_upgrade.escript"},
   {copy, "files/sys.config", "releases/\{\{rel_vsn\}\}/sys.config"},
   {copy, "files/vm.args", "releases/\{\{rel_vsn\}\}/vm.args"}
]}.
